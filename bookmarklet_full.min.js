!function(){var e,t;e=this,t=function(){var e=function(e){return e.reduce((function(e,t){return 2*e+t}),0)},t=function(e){for(var t=[],n=7;n>=0;n--)t.push(!!(e&1<<n));return t},n=function(e){this.data=e,this.len=this.data.length,this.pos=0,this.readByte=function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return e instanceof Uint8Array?e[this.pos++]:255&e.charCodeAt(this.pos++)},this.readBytes=function(e){for(var t=[],n=0;n<e;n++)t.push(this.readByte());return t},this.read=function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(this.readByte());return t},this.readUnsigned=function(){var e=this.readBytes(2);return(e[1]<<8)+e[0]}},r=function(n,r){r||(r={});var a=function(e){for(var t=[],r=0;r<e;r++)t.push(n.readBytes(3));return t},o=function(){var e,t;t="";do{e=n.readByte(),t+=n.read(e)}while(0!==e);return t},i=function(i){i.leftPos=n.readUnsigned(),i.topPos=n.readUnsigned(),i.width=n.readUnsigned(),i.height=n.readUnsigned();var l=t(n.readByte());i.lctFlag=l.shift(),i.interlaced=l.shift(),i.sorted=l.shift(),i.reserved=l.splice(0,2),i.lctSize=e(l.splice(0,3)),i.lctFlag&&(i.lct=a(1<<i.lctSize+1)),i.lzwMinCodeSize=n.readByte();var s=o();i.pixels=function(e,t){for(var n,r,a=0,o=function(e){for(var n=0,r=0;r<e;r++)t.charCodeAt(a>>3)&1<<(7&a)&&(n|=1<<r),a++;return n},i=[],l=1<<e,s=l+1,c=e+1,d=[],u=function(){d=[],c=e+1;for(var t=0;t<l;t++)d[t]=[t];d[l]=[],d[s]=null};;)if(r=n,(n=o(c))!==l){if(n===s)break;if(n<d.length)r!==l&&d.push(d[r].concat(d[n][0]));else{if(n!==d.length)throw new Error("Invalid LZW code.");d.push(d[r].concat(d[r][0]))}i.push.apply(i,d[n]),d.length===1<<c&&c<12&&c++}else u();return i}(i.lzwMinCodeSize,s),i.interlaced&&(i.pixels=function(e,t){for(var n=new Array(e.length),r=e.length/t,a=function(r,a){var o=e.slice(a*t,(a+1)*t);n.splice.apply(n,[r*t,t].concat(o))},o=[0,4,2,1],i=[8,8,4,2],l=0,s=0;s<4;s++)for(var c=o[s];c<r;c+=i[s])a(c,l),l++;return n}(i.pixels,i.width)),r.img&&r.img(i)},l=function(){var a={};switch(a.sentinel=n.readByte(),String.fromCharCode(a.sentinel)){case"!":a.type="ext",function(a){switch(a.label=n.readByte(),a.label){case 249:a.extType="gce",function(a){n.readByte();var o=t(n.readByte());a.reserved=o.splice(0,3),a.disposalMethod=e(o.splice(0,3)),a.userInput=o.shift(),a.transparencyGiven=o.shift(),a.delayTime=n.readUnsigned(),a.transparencyIndex=n.readByte(),a.terminator=n.readByte(),r.gce&&r.gce(a)}(a);break;case 254:a.extType="com",function(e){e.comment=o(),r.com&&r.com(e)}(a);break;case 1:a.extType="pte",function(e){n.readByte(),e.ptHeader=n.readBytes(12),e.ptData=o(),r.pte&&r.pte(e)}(a);break;case 255:a.extType="app",function(e){switch(n.readByte(),e.identifier=n.read(8),e.authCode=n.read(3),e.identifier){case"NETSCAPE":!function(e){n.readByte(),e.unknown=n.readByte(),e.iterations=n.readUnsigned(),e.terminator=n.readByte(),r.app&&r.app.NETSCAPE&&r.app.NETSCAPE(e)}(e);break;default:!function(e){e.appData=o(),r.app&&r.app[e.identifier]&&r.app[e.identifier](e)}(e)}}(a);break;default:a.extType="unknown",function(e){e.data=o(),r.unknown&&r.unknown(e)}(a)}}(a);break;case",":a.type="img",i(a);break;case";":a.type="eof",r.eof&&r.eof(a);break;default:throw new Error("Unknown block: 0x"+a.sentinel.toString(16))}"eof"!==a.type&&setTimeout(l,0)};!function(){var o={};if(o.sig=n.read(3),o.ver=n.read(3),"GIF"!==o.sig)throw new Error("Not a GIF file.");o.width=n.readUnsigned(),o.height=n.readUnsigned();var i=t(n.readByte());o.gctFlag=i.shift(),o.colorRes=e(i.splice(0,3)),o.sorted=i.shift(),o.gctSize=e(i.splice(0,3)),o.bgColor=n.readByte(),o.pixelAspectRatio=n.readByte(),o.gctFlag&&(o.gct=a(1<<o.gctSize+1)),r.hdr&&r.hdr(o)}(),setTimeout(l,0)};return function(e){var t,a,o={vp_l:0,vp_t:0,vp_w:null,vp_h:null,c_w:null,c_h:null};for(var i in e)o[i]=e[i];o.vp_w&&o.vp_h&&(o.is_vp=!0);var l,s=null,c=!1,d=null,u=null,p=null,h=null,f=null,g=null,m=null,_=!0,y=!1,v=[],w=[],x=1,b=o.gif;void 0===o.auto_play&&(o.auto_play=!b.getAttribute("rel:auto_play")||"1"==b.getAttribute("rel:auto_play"));var E,T,k,C,B=o.hasOwnProperty("on_end")?o.on_end:null,P=o.hasOwnProperty("loop_delay")?o.loop_delay:0,S=o.hasOwnProperty("loop_mode")?o.loop_mode:"auto",A=!o.hasOwnProperty("draw_while_loading")||o.draw_while_loading,I=!!A&&(!o.hasOwnProperty("show_progress_bar")||o.show_progress_bar),L=o.hasOwnProperty("progressbar_height")?o.progressbar_height:25,U=o.hasOwnProperty("progressbar_background_color")?o.progressbar_background_color:"rgba(255,255,255,0.4)",M=o.hasOwnProperty("progressbar_foreground_color")?o.progressbar_foreground_color:"rgba(255,0,22,.8)",N=function(){d=null,u=null,f=p,p=null,g=null},O=function(){try{r(t,q)}catch(e){D("parse")}},R=function(e,t){E.width=e*V(),E.height=t*V(),k.style.minWidth=e*V()+"px",C.width=e,C.height=t,C.style.width=e+"px",C.style.height=t+"px",C.getContext("2d").setTransform(1,0,0,1,0,0)},j=function(e,t,n){if(n&&I){var r,a,i,l=L;o.is_vp?y?(a=(o.vp_t+o.vp_h-l)/V(),l/=V(),r=o.vp_l/V()+e/t*(o.vp_w/V()),i=E.width/V()):(a=o.vp_t+o.vp_h-l,l=l,r=o.vp_l+e/t*o.vp_w,i=E.width):(a=(E.height-l)/(y?V():1),r=e/t*E.width/(y?V():1),i=E.width/(y?V():1),l/=y?V():1),T.fillStyle=U,T.fillRect(r,a,i-r,l),T.fillStyle=M,T.fillRect(0,a,r,l)}},D=function(e){s=e,a={width:b.width,height:b.height},v=[],T.fillStyle="black",T.fillRect(0,0,o.c_w?o.c_w:a.width,o.c_h?o.c_h:a.height),T.strokeStyle="red",T.lineWidth=3,T.moveTo(0,0),T.lineTo(o.c_w?o.c_w:a.width,o.c_h?o.c_h:a.height),T.moveTo(0,o.c_h?o.c_h:a.height),T.lineTo(o.c_w?o.c_w:a.width,0),T.stroke()},z=function(){g&&(v.push({data:g.getImageData(0,0,a.width,a.height),delay:u}),w.push({x:0,y:0}))},W=function(){var e,t,n,r=-1,a=0,i=function(e){r+=e,d()},c=(e=!1,t=function(){null!==B&&B(b),a++,!1!==S||a<0?n():(e=!1,_=!1)},n=function(){if(e=_){i(1);var a=10*v[r].delay;a||(a=100),a*=x,0==(r+1+v.length)%v.length?(a+=P,setTimeout(t,a)):setTimeout(n,a)}},function(){e||setTimeout(n,0)}),d=function(){var e;l&&l(r),(r=parseInt(r,10))>v.length-1&&(r=0),r<0&&(r=0),e=w[r],C.getContext("2d").putImageData(v[r].data,e.x,e.y),T.globalCompositeOperation="copy",T.drawImage(C,0,0)};return{init:function(){s||(o.c_w&&o.c_h||T.scale(V(),V()),o.auto_play?c():(r=0,d()))},step:c,play:function(){_=!0,c()},pause:function(){_=!1},playing:_,move_relative:i,current_frame:function(){return r},length:function(){return v.length},move_to:function(e){r=e,d()}}}(),F=function(e){j(t.pos,t.data.length,e)},G=function(){},H=function(e,t){return function(n){e(n),F(t)}},q={hdr:H((function(e){R((a=e).width,a.height)})),gce:H((function(e){z(),N(),d=e.transparencyGiven?e.transparencyIndex:null,u=e.delayTime,p=e.disposalMethod})),com:H(G),app:{NETSCAPE:H(G)},img:H((function(e){g||(g=C.getContext("2d"));var t=v.length,n=e.lctFlag?e.lct:a.gct;t>0&&(3===f?null!==h?g.putImageData(v[h].data,0,0):g.clearRect(m.leftPos,m.topPos,m.width,m.height):h=t-1,2===f&&g.clearRect(m.leftPos,m.topPos,m.width,m.height));var r=g.getImageData(e.leftPos,e.topPos,e.width,e.height);e.pixels.forEach((function(e,t){e!==d&&(r.data[4*t+0]=n[e][0],r.data[4*t+1]=n[e][1],r.data[4*t+2]=n[e][2],r.data[4*t+3]=255)})),g.putImageData(r,e.leftPos,e.topPos),y||(T.scale(V(),V()),y=!0),A&&(T.drawImage(C,0,0),A=o.auto_play),m=e}),!0),eof:function(){z(),F(!1),o.c_w&&o.c_h||(E.width=a.width*V(),E.height=a.height*V()),W.init(),c=!1,$&&$(b)}},X=function(){var e=b.parentNode,t=document.createElement("div");E=document.createElement("canvas"),T=E.getContext("2d"),k=document.createElement("div"),C=document.createElement("canvas"),t.width=E.width=b.width,t.height=E.height=b.height,k.style.minWidth=b.width+"px",t.className="jsgif",k.className="jsgif_toolbar",t.appendChild(E),t.appendChild(k),e.insertBefore(t,b),e.removeChild(b),o.c_w&&o.c_h&&R(o.c_w,o.c_h),Z=!0},V=function(){return o.max_width&&a&&a.width>o.max_width?o.max_width/a.width:1},Z=!1,$=!1,J=function(e){return!c&&($=e||!1,c=!0,v=[],N(),h=null,f=null,g=null,m=null,!0)};return{play:W.play,pause:W.pause,move_relative:W.move_relative,move_to:W.move_to,get_playing:function(){return _},get_canvas:function(){return E},get_canvas_scale:function(){return V()},get_loading:function(){return c},get_auto_play:function(){return o.auto_play},get_length:function(){return W.length()},get_current_frame:function(){return W.current_frame()},load_url:function(e,r){if(J(r)){var a=new XMLHttpRequest;a.open("GET",e,!0),"overrideMimeType"in a?a.overrideMimeType("text/plain; charset=x-user-defined"):"responseType"in a?a.responseType="arraybuffer":a.setRequestHeader("Accept-Charset","x-user-defined"),a.onloadstart=function(){Z||X()},a.onload=function(){200!=this.status&&D("xhr - response"),"response"in this||(this.response=new VBArray(this.responseText).toArray().map(String.fromCharCode).join(""));var e=this.response;e.toString().indexOf("ArrayBuffer")>0&&(e=new Uint8Array(e)),t=new n(e),setTimeout(O,0)},a.onprogress=function(e){e.lengthComputable&&j(e.loaded,e.total,!0)},a.onerror=function(){D("xhr")},a.send()}},load:function(e){this.load_url(b.getAttribute("rel:animated_src")||b.src,e)},load_raw:function(e,r){J(r)&&(Z||X(),t=new n(e),setTimeout(O,0))},set_frame_offset:function(e,t){w[e]?(void 0!==t.x&&(w[e].x=t.x),void 0!==t.y&&(w[e].y=t.y)):w[e]=t},set_multiplier:function(e){x=e},on_frame_change:function(e){l=e}}}},"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.SuperGif=t(),function(){"use strict";function e(e){const t=new SuperGif({gif:e,auto_play:!0});t.load(()=>{const e=t.get_canvas().parentElement.querySelector(".jsgif_toolbar");e.style.setProperty("font-family","sans-serif","important"),e.style.maxWidth=e.style.minWidth,e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation()});const n=document.createElement("div");n.className="jsgif-bookmarklet-pbar",e.appendChild(n);const r=t.get_length()-1;t.on_frame_change(e=>{e===r+1&&(e=0);const t=Math.round(e/r*100)+"%";n.innerText=e+"/"+r+" ("+t+")",n.style.setProperty("background-image","linear-gradient(90deg, gray "+t+", #eee "+t+", #eee 100%)","important")});let a=!1;function o(e){const a=n.getBoundingClientRect(),o=e.clientX-a.x,i=Math.round(o/a.width*r);t.move_to(i)}n.addEventListener("mousedown",e=>{a=!0,o(e)}),n.addEventListener("mousemove",e=>{a&&o(e)}),window.addEventListener("mouseup",()=>a=!1);const i=document.createElement("div");function l(e,t){const n=document.createElement("button");return n.className="jsgif-bookmarklet-btn",n.innerText=e,n.addEventListener("click",t),i.appendChild(n),n}e.appendChild(i),l("⏸",e=>{t.get_playing()?(e.target.innerHTML="▶",t.pause()):(e.target.innerHTML="⏸",t.play())}),l("⬅",()=>{t.get_current_frame()<=0?t.move_to(r):t.move_relative(-1)}),l("➡",()=>{t.get_current_frame()>=r?t.move_to(0):t.move_relative(1)}),l("⏹",()=>{t.pause(),t.move_to(0)});const s=document.createElement("select");[.25,.5,1,1.5,2].forEach(e=>{const t=document.createElement("option");t.innerText="x"+e,t.value=e,1===e&&(t.selected=!0),s.appendChild(t)}),s.addEventListener("input",()=>{t.set_multiplier(1/s.value)}),i.appendChild(s)})}const t=document.querySelectorAll('img[src$=".gif"]');if(t.length>0){Array.from(t).forEach(t=>{let n;t.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),t.complete&&void 0!==t.naturalWidth&&0!==t.naturalWidth?e(t):t.onload=()=>e(t)}),t.addEventListener("mouseover",()=>{n=t.style.filter,t.style.filter=n+"brightness(0.3)"}),t.addEventListener("mouseout",()=>t.style.filter=n)});const n=document.createElement("style");n.innerText='.jsgif-bookmarklet-pbar{color:#000!important;background-color:#eee!important;text-decoration:none!important;cursor:default!important;user-select:none!important;text-align:center!important;}.jsgif-bookmarklet-btn{font-family:"Segoe UI Symbol", sans-serif!important;height:30px!important;width:30px!important;}',document.head.appendChild(n)}}()}();